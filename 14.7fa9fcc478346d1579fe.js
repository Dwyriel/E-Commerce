(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"2MiI":function(t,i,e){"use strict";e.d(i,"a",function(){return u});var s=e("OGMK"),n=e("fXoL"),r=e("ofXK"),o=e("TEn/");function c(t,i){if(1&t&&(n.Rb(0,"ion-header",3),n.Rb(1,"ion-toolbar"),n.Rb(2,"ion-buttons",4),n.Nb(3,"ion-menu-button"),n.Qb(),n.Rb(4,"ion-title"),n.qc(5),n.Qb(),n.Qb(),n.Qb()),2&t){const t=n.bc();n.gc("translucent",!0),n.Bb(5),n.rc(t.title)}}function a(t,i){if(1&t&&(n.Rb(0,"ion-header",5),n.Rb(1,"ion-toolbar"),n.Rb(2,"ion-title",6),n.qc(3),n.Qb(),n.Qb(),n.Qb()),2&t){const t=n.bc();n.Bb(3),n.rc(t.title)}}function l(t,i){1&t&&n.Nb(0,"div",7)}let u=(()=>{class t{constructor(){this.title="",this.isMobile=!0}ngOnInit(){this.subscription&&!this.subscription.closed&&this.subscription.unsubscribe(),this.subscription=s.a.GetAppInfo().subscribe(t=>{this.isMobile=t.appWidth<=s.a.maxMobileWidth})}ngOnDestroy(){this.subscription&&!this.subscription.closed&&this.subscription.unsubscribe()}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=n.Gb({type:t,selectors:[["app-header"]],inputs:{title:"title",segment:"segment"},decls:3,vars:3,consts:[[3,"translucent",4,"ngIf"],["collapse","condense",4,"ngIf"],["style","width: 100%; height: 65px;",4,"ngIf"],[3,"translucent"],["slot","start"],["collapse","condense"],["size","large"],[2,"width","100%","height","65px"]],template:function(t,i){1&t&&(n.pc(0,c,6,2,"ion-header",0),n.pc(1,a,4,1,"ion-header",1),n.pc(2,l,1,0,"div",2)),2&t&&(n.gc("ngIf",i.isMobile&&"0"==i.segment),n.Bb(1),n.gc("ngIf",i.isMobile&&"1"==i.segment),n.Bb(1),n.gc("ngIf",!i.isMobile&&"0"==i.segment))},directives:[r.k,o.j,o.K,o.f,o.t,o.J],styles:[""]}),t})()},dagM:function(t,i,e){"use strict";e.d(i,"a",function(){return a});var s=e("ofXK"),n=e("3Pt+"),r=e("tyNb"),o=e("TEn/"),c=e("fXoL");let a=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({imports:[[o.L,s.b,n.a,r.k]]}),t})()},tZSS:function(t,i,e){"use strict";e.r(i),e.d(i,"CartPageModule",function(){return O});var s=e("ofXK"),n=e("3Pt+"),r=e("TEn/"),o=e("tyNb"),c=e("mrSG"),a=e("OGMK"),l=e("fcTE"),u=e("fXoL"),d=e("qfBg"),h=e("3LUQ"),b=e("Gdn9"),p=e("c14U"),g=e("xHty"),f=e("2MiI");function m(t,i){1&t&&(u.Rb(0,"div"),u.Rb(1,"p",6),u.qc(2,"You have no itens in your cart"),u.Qb(),u.Qb())}function v(t,i){if(1&t&&u.Nb(0,"img",16),2&t){const t=u.bc().$implicit;u.gc("src",t.product.gallery[0],u.nc)("alt",t.product.name)}}function y(t,i){if(1&t){const t=u.Sb();u.Rb(0,"ion-row"),u.Rb(1,"ion-col",8),u.Rb(2,"ion-item",9),u.pc(3,v,1,2,"img",10),u.Rb(4,"ion-label"),u.Rb(5,"h2"),u.qc(6),u.Qb(),u.Rb(7,"h3"),u.qc(8),u.cc(9,"currency"),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Rb(10,"ion-col",11),u.Rb(11,"ion-icon",12),u.Zb("click",function(){u.mc(t);const e=i.$implicit;return u.bc(2).DecreaseAmount(e.product.id)}),u.Qb(),u.Qb(),u.Rb(12,"ion-col",13),u.Rb(13,"h2"),u.qc(14),u.Qb(),u.Qb(),u.Rb(15,"ion-col",14),u.Rb(16,"ion-icon",15),u.Zb("click",function(){u.mc(t);const e=i.$implicit;return u.bc(2).IncreaseAmount(e.product.id)}),u.Qb(),u.Qb(),u.Qb()}if(2&t){const t=i.$implicit;u.Bb(2),u.ic("routerLink","/product/",t.product.id,""),u.Bb(1),u.gc("ngIf",(null==t.product.gallery?null:t.product.gallery.length)>0),u.Bb(3),u.rc(t.product.name),u.Bb(2),u.rc(u.dc(9,5,t.product.price,"BRL")),u.Bb(6),u.rc(t.amount)}}function S(t,i){if(1&t&&(u.Rb(0,"ion-list"),u.Rb(1,"ion-grid"),u.pc(2,y,17,8,"ion-row",7),u.Qb(),u.Qb()),2&t){const t=u.bc();u.Bb(2),u.gc("ngForOf",t.products)}}function I(t,i){if(1&t){const t=u.Sb();u.Rb(0,"ion-button",17),u.Zb("click",function(){return u.mc(t),u.bc().FinishPurchase()}),u.qc(1,"Finalizar Compra"),u.Qb()}}const w=function(t){return{webrowser:t}},A=[{path:"",component:(()=>{class t{constructor(t,i,e,s,n,r){this.userService=t,this.alertService=i,this.router=e,this.prodServ=s,this.cartServ=n,this.purchaseService=r,this.products=[],this.loading=!0,this.subscriptions=[]}ngOnInit(){}ionViewWillEnter(){this.getUserAndCart(),this.GetPlataformInfo()}ionViewWillLeave(){if(this.loading=!0,this.user=null,this.products=[],this.subscription1&&!this.subscription1.closed&&this.subscription1.unsubscribe(),this.subscription2&&!this.subscription2.closed&&this.subscription2.unsubscribe(),this.subscriptions&&this.subscriptions.length>0){for(var t of this.subscriptions)t&&!t.closed&&t.unsubscribe();this.subscriptions=[]}}GetPlataformInfo(){this.subscription2=a.a.GetAppInfo().subscribe(t=>{this.isMobile=t.appWidth<=a.a.maxMobileWidth,this.setDivWidth(.4*t.appWidth>a.a.maxMobileWidth/1.5?"40%":a.a.maxMobileWidth/1.5+"px")})}setDivWidth(t){document.body.style.setProperty("--maxWidth",t)}getUserAndCart(){return Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.subscription1&&!this.subscription1.closed&&this.subscription1.unsubscribe(),this.subscription1=a.a.GetUserInfo().subscribe(t=>Object(c.b)(this,void 0,void 0,function*(){if(!t)return yield this.router.navigate(["/login"]),void(yield this.alertService.dismissLoading(this.loadingAlert));this.user=t,this.user&&this.user.cart&&this.user.cart.length>0?(this.hasProducts=!0,yield this.getProducts()):(this.hasProducts=!1,this.loading&&(yield this.alertService.dismissLoading(this.loadingAlert),this.loading=!1))}),t=>Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.presentAlert("Ops","Algo deu errado, tente novamente mais tarde.")}))})}getProducts(){return Object(c.b)(this,void 0,void 0,function*(){var t=[];if(this.subscriptions&&this.subscriptions.length>0){for(var i of this.subscriptions)i&&!i.closed&&i.unsubscribe();this.subscriptions=[]}var e=!0,s=!0,n=0,r=this.user.cart&&this.user.cart.length>0?this.user.cart.length:null;for(var o of this.user.cart)for(s=!0,this.subscriptions.push((yield this.prodServ.Get(o.productID)).subscribe(i=>{var c=i;c.id=o.productID,t.push({product:c,amount:o.amount}),++n>=r&&(e=!1),s=!1}));s;)yield new Promise(t=>setTimeout(t,10));for(;e;)yield new Promise(t=>setTimeout(t,10));this.products=t,this.loading&&(yield this.alertService.dismissLoading(this.loadingAlert),this.loading=!1)})}DecreaseAmount(t){return Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.cartServ.RemoveItem(t,this.user.cart),console.log(this.user.cart),yield this.SendChanges(t,!1)})}IncreaseAmount(t){return Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.cartServ.AddItem(t,this.user.cart),yield this.SendChanges(t,!0)})}SendChanges(t,i){return Object(c.b)(this,void 0,void 0,function*(){yield this.userService.UpdateCart(this.user.id,this.user.cart).then(t=>Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.ShowToast("Itens Changed")}),e=>Object(c.b)(this,void 0,void 0,function*(){t&&null!=i&&(i?this.cartServ.RemoveItem(t,this.user.cart):this.cartServ.AddItem(t,this.user.cart),yield this.alertService.presentAlert("Oops",`There was a problem ${i?"increasing":"decreasing"} the amount of the item from the cart`))}))})}FinishPurchase(){return Object(c.b)(this,void 0,void 0,function*(){var t;if(yield this.alertService.confirmationAlert("Comprar","Clique em ok para efetuar a compra.").then(i=>t=i),t){for(var i of(yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.products)){var e=!0,s=Object(l.a)(this.user.id,i.product.sellerID,{productID:i.product.id,amount:i.amount});for(yield this.purchaseService.Add(s).catch(t=>{this.alertService.presentAlert("Ocorreu um erro",`Produto ${i.product.name} n\xe3o pode ser comprado, tente novamente mais tarde.`)}).finally(()=>{e=!1});e;)yield new Promise(t=>setTimeout(t,10))}yield this.userService.UpdateCart(this.user.id,[]).then(()=>Object(c.b)(this,void 0,void 0,function*(){this.user.cart=[],this.products=[],yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.presentAlert("Wheee","The itens you purchased will be shipped in the next 2534 years"),yield this.router.navigate(["/purchases/purchases"])}),t=>Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.presentAlert("Ops","N\xe3o foi possivel remover os itens do carrinho apos a compra, Por favor verifique suas compras antes de comprar novamente.")}))}})}}return t.\u0275fac=function(i){return new(i||t)(u.Mb(d.a),u.Mb(h.a),u.Mb(o.g),u.Mb(b.a),u.Mb(p.a),u.Mb(g.a))},t.\u0275cmp=u.Gb({type:t,selectors:[["app-cart"]],decls:7,vars:7,consts:[["title","Carrinho","segment","0"],[3,"fullscreen"],["title","Carrinho","segment","1"],[3,"ngClass"],[4,"ngIf"],["vertical","bottom","expand","block","size","large","class","ion-margin",3,"click",4,"ngIf"],[1,"ion-text-center"],[4,"ngFor","ngForOf"],["size","9"],[3,"routerLink"],[3,"src","alt",4,"ngIf"],["size","1",1,"vertical-align-content","ion-justify-content-end"],["name","chevron-back-outline",3,"click"],["size","1",2,"text-align","center"],["size","1",1,"vertical-align-content","ion-justify-content-start"],["name","chevron-forward-outline",3,"click"],[3,"src","alt"],["vertical","bottom","expand","block","size","large",1,"ion-margin",3,"click"]],template:function(t,i){1&t&&(u.Nb(0,"app-header",0),u.Rb(1,"ion-content",1),u.Nb(2,"app-header",2),u.Rb(3,"div",3),u.pc(4,m,3,0,"div",4),u.pc(5,S,3,1,"ion-list",4),u.pc(6,I,2,0,"ion-button",5),u.Qb(),u.Qb()),2&t&&(u.Bb(1),u.gc("fullscreen",!0),u.Bb(2),u.gc("ngClass",u.jc(5,w,!i.isMobile)),u.Bb(1),u.gc("ngIf",!i.hasProducts),u.Bb(1),u.gc("ngIf",i.hasProducts),u.Bb(1),u.gc("ngIf",i.hasProducts))},directives:[f.a,r.h,s.i,s.k,r.q,r.i,s.j,r.z,r.g,r.n,r.T,o.h,r.p,r.k,r.e],pipes:[s.c],styles:[".webrowser[_ngcontent-%COMP%]{text-align:center;width:var(--maxWidth);margin:0 auto;padding-top:1rem}img[_ngcontent-%COMP%]{border-radius:10%;height:40px;width:40px;margin:0 7px 0 0}.vertical-align-content[_ngcontent-%COMP%]{display:flex!important;align-content:center!important;align-items:center!important}"]}),t})()}];let R=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=u.Kb({type:t}),t.\u0275inj=u.Jb({imports:[[o.k.forChild(A)],o.k]}),t})();var M=e("dagM");let O=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=u.Kb({type:t}),t.\u0275inj=u.Jb({imports:[[s.b,n.a,r.L,R,M.a]]}),t})()}}]);