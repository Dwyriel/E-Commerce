<app-header [title]="title" segment=0></app-header>

<ion-content [fullscreen]="true">
  <app-header [title]="title" segment=1></app-header>
  <div [ngClass]="{'webrowser':!isMobile}" class="ion-margin">
    <ion-slides pager="true" [options]="slideOpts">
      <ion-slide *ngFor="let photo of product.gallery; let i = index">
        <ion-img [src]="photo"></ion-img>
      </ion-slide>
    </ion-slides>
    <h2>{{product.name}}</h2>
    <p>
      <span class="tooltip"> Avaliação: {{(product.avgReview || product.avgReview == 0 )? (product.avgReview + "%") : "Nenhum"}}
        <span class="tooltiptext tooltip-top">
          <ion-badge class="badge-bottom" color="success" mode="ios" >{{positivos}}</ion-badge> - 
          <ion-badge class="badge-bottom" color="danger" mode="ios">{{negativos}}</ion-badge>
        </span>
      </span>
    </p>
    <p>{{product.price | currency:'BRL'}}</p>
    <ion-button [disabled]="(1 > product.stock) || (loggedUser && loggedUser.id == product.sellerID)" (click)="AddToCart()">Adicionar no carrinho</ion-button>
    <h3 >Descrição:</h3>
    <p>
      <ion-text>{{product.description}}</ion-text>
    </p>
    <ion-row class="ion-padding-vertical ion-align-items-center ion-justify-content-start" id="product-seller">
      <img *ngIf="!SellerUser.photo" id="sellerimage" src="../../../assets/perfil.png"
        routerLink="/profile/{{product.sellerID}}">
      <img *ngIf="SellerUser.photo" id="sellerimage" [src]="SellerUser.photo"
        routerLink="/profile/{{product.sellerID}}">
      <ion-label routerLink="/profile/{{product.sellerID}}">
        <h3>Vendedor: </h3>
        <h2>{{SellerUser.name}}</h2>
      </ion-label>
    </ion-row>



    <div *ngIf="questions">
      <div>
        <h4>Perguntas:</h4>
        <div *ngFor="let asked of questions">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{asked.user.name}}</ion-card-title>
              <ion-card-subtitle>{{asked.date.toLocaleString()}}</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              {{asked.text}}
            </ion-card-content>
            <ng-container *ngIf="product.sellerID == loggedUser.id">
            <ion-item style="text-align: end;" *ngIf=""> <!--more tests-->
              <a (click)="dropdown = true">Responder</a>
            </ion-item>
            <div style="margin-left: 10px" *ngIf="">
              <a style="text-align: end;">Resposta</a>
              <br>
              <h5>{{SellerUser.name}}</h5>
              <br>
              <ion-text>{{asked.replyDate.toLocaleString()}}</ion-text>
              <br>
              <p>{{asked.vendorText}}</p>
          </div>
          </ng-container>
            <div *ngIf="dropdown" class="dropdown" #dropdownbox>
              <ion-item>
              <ion-input name="reply" [(ngModel)]=reply required autoGrow=true></ion-input>
              <ion-row class="ion-justify-content-end commentButtons">
                <ion-button class="leftCommentButton" expand=full size="small" (click)="submitReply(asked.id);"
                  >Responder</ion-button>
                <ion-button class="rightCommentButton" expand=full size="small" (click)="dropdown=false">Cancelar</ion-button>
              </ion-row>
            </ion-item>
          </div>
          </ion-card>
      </div>
    </div>
    </div>

    <div class="ion-margin-vertical">
      <ion-item>
        <ion-label position="floating">Duvida? faça uma pergunta</ion-label>
        <ion-textarea name="question" [(ngModel)]=question required autoGrow=true></ion-textarea>
        <ion-row class="ion-justify-content-end commentButtons">
          <ion-button class="leftCommentButton" expand=full size="small" (click)="submitButton();"
            >Enviar</ion-button>
          <ion-button class="rightCommentButton" expand=full size="small" (click)="cancelButton();">Cancel</ion-button>
        </ion-row>
      </ion-item>
    </div>
 








    <!-- <ion-item *ngIf="!hasReviews">
        <ion-label>Produto sem avaliações</ion-label>
    </ion-item>
    <div *ngIf="hasReviews">
      <ion-text class="reviewsTitle">Avaliações:</ion-text>
      <div class="reviews" *ngFor="let review of product.reviews">
        <ion-row class="ion-justify-content-between">
          <ion-row class="ion-align-items-center">
            <ion-badge class="reviewThumb" color="{{(review.recommend) ? 'success' : 'danger'}}"><ion-icon size="large" color="dark" name="thumbs-{{(review.recommend) ? 'up' : 'down'}}-sharp"></ion-icon></ion-badge>
            <ion-text>{{review.title}}</ion-text>
          </ion-row>
          <div class="ion-text-end">
            <ion-note>{{review.date.toLocaleString()}}</ion-note>
          </div>
        </ion-row>
        <div class="reviewText">
          <ion-text>{{review.text}}</ion-text>
        </div>
      </div>
    </div> -->
  </div>
</ion-content>