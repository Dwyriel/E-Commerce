(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"2MiI":function(t,i,e){"use strict";e.d(i,"a",function(){return l});var s=e("OGMK"),n=e("fXoL"),r=e("ofXK"),o=e("TEn/");function c(t,i){if(1&t&&(n.Rb(0,"ion-header",3),n.Rb(1,"ion-toolbar"),n.Rb(2,"ion-buttons",4),n.Nb(3,"ion-menu-button"),n.Qb(),n.Rb(4,"ion-title"),n.qc(5),n.Qb(),n.Qb(),n.Qb()),2&t){const t=n.bc();n.gc("translucent",!0),n.Bb(5),n.rc(t.title)}}function a(t,i){if(1&t&&(n.Rb(0,"ion-header",5),n.Rb(1,"ion-toolbar"),n.Rb(2,"ion-title",6),n.qc(3),n.Qb(),n.Qb(),n.Qb()),2&t){const t=n.bc();n.Bb(3),n.rc(t.title)}}function u(t,i){1&t&&n.Nb(0,"div",7)}let l=(()=>{class t{constructor(){this.title="",this.isMobile=!0}ngOnInit(){this.subscription&&!this.subscription.closed&&this.subscription.unsubscribe(),this.subscription=s.a.GetAppInfo().subscribe(t=>{this.isMobile=t.appWidth<=s.a.maxMobileWidth})}ngOnDestroy(){this.subscription&&!this.subscription.closed&&this.subscription.unsubscribe()}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=n.Gb({type:t,selectors:[["app-header"]],inputs:{title:"title",segment:"segment"},decls:3,vars:3,consts:[[3,"translucent",4,"ngIf"],["collapse","condense",4,"ngIf"],["style","width: 100%; height: 65px;",4,"ngIf"],[3,"translucent"],["slot","start"],["collapse","condense"],["size","large"],[2,"width","100%","height","65px"]],template:function(t,i){1&t&&(n.pc(0,c,6,2,"ion-header",0),n.pc(1,a,4,1,"ion-header",1),n.pc(2,u,1,0,"div",2)),2&t&&(n.gc("ngIf",i.isMobile&&"0"==i.segment),n.Bb(1),n.gc("ngIf",i.isMobile&&"1"==i.segment),n.Bb(1),n.gc("ngIf",!i.isMobile&&"0"==i.segment))},directives:[r.k,o.o,o.S,o.f,o.B,o.R],styles:[""]}),t})()},dagM:function(t,i,e){"use strict";e.d(i,"a",function(){return a});var s=e("ofXK"),n=e("3Pt+"),r=e("tyNb"),o=e("TEn/"),c=e("fXoL");let a=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=c.Kb({type:t}),t.\u0275inj=c.Jb({imports:[[o.T,s.b,n.a,r.k]]}),t})()},tZSS:function(t,i,e){"use strict";e.r(i),e.d(i,"CartPageModule",function(){return M});var s=e("ofXK"),n=e("3Pt+"),r=e("TEn/"),o=e("tyNb"),c=e("mrSG"),a=e("OGMK"),u=e("fcTE"),l=e("fXoL"),d=e("qfBg"),h=e("3LUQ"),b=e("Gdn9"),p=e("c14U"),g=e("xHty"),f=e("2MiI");function m(t,i){1&t&&(l.Rb(0,"div"),l.Rb(1,"p",6),l.qc(2,"You have no itens in your cart"),l.Qb(),l.Qb())}function v(t,i){if(1&t&&l.Nb(0,"img",16),2&t){const t=l.bc().$implicit;l.gc("src",t.product.gallery[0],l.nc)("alt",t.product.name)}}function y(t,i){if(1&t){const t=l.Sb();l.Rb(0,"ion-row"),l.Rb(1,"ion-col",8),l.Rb(2,"ion-item",9),l.pc(3,v,1,2,"img",10),l.Rb(4,"ion-label"),l.Rb(5,"h2"),l.qc(6),l.Qb(),l.Rb(7,"h3"),l.qc(8),l.cc(9,"currency"),l.Qb(),l.Qb(),l.Qb(),l.Qb(),l.Rb(10,"ion-col",11),l.Rb(11,"ion-icon",12),l.Zb("click",function(){l.mc(t);const e=i.$implicit;return l.bc(2).DecreaseAmount(e.product.id)}),l.Qb(),l.Qb(),l.Rb(12,"ion-col",13),l.Rb(13,"h2"),l.qc(14),l.Qb(),l.Qb(),l.Rb(15,"ion-col",14),l.Rb(16,"ion-icon",15),l.Zb("click",function(){l.mc(t);const e=i.$implicit;return l.bc(2).IncreaseAmount(e.product.id,e.product.stock,e.amount)}),l.Qb(),l.Qb(),l.Qb()}if(2&t){const t=i.$implicit;l.Bb(2),l.ic("routerLink","/product/",t.product.id,""),l.Bb(1),l.gc("ngIf",(null==t.product.gallery?null:t.product.gallery.length)>0),l.Bb(3),l.rc(t.product.name),l.Bb(2),l.rc(l.dc(9,5,t.product.price,"BRL")),l.Bb(6),l.rc(t.amount)}}function S(t,i){if(1&t&&(l.Rb(0,"ion-list"),l.Rb(1,"ion-grid"),l.pc(2,y,17,8,"ion-row",7),l.Qb(),l.Qb()),2&t){const t=l.bc();l.Bb(2),l.gc("ngForOf",t.products)}}function I(t,i){if(1&t){const t=l.Sb();l.Rb(0,"ion-button",17),l.Zb("click",function(){return l.mc(t),l.bc().FinishPurchase()}),l.qc(1,"Finalizar Compra"),l.Qb()}}const w=function(t){return{webrowser:t}},A=[{path:"",component:(()=>{class t{constructor(t,i,e,s,n,r){this.userService=t,this.alertService=i,this.router=e,this.prodServ=s,this.cartServ=n,this.purchaseService=r,this.products=[],this.loading=!0,this.subscriptions=[]}ngOnInit(){}ionViewWillEnter(){this.getUserAndCart(),this.GetPlataformInfo()}ionViewWillLeave(){if(this.loading=!0,this.user=null,this.products=[],this.subscription1&&!this.subscription1.closed&&this.subscription1.unsubscribe(),this.subscription2&&!this.subscription2.closed&&this.subscription2.unsubscribe(),this.subscriptions&&this.subscriptions.length>0){for(var t of this.subscriptions)t&&!t.closed&&t.unsubscribe();this.subscriptions=[]}}GetPlataformInfo(){this.subscription2=a.a.GetAppInfo().subscribe(t=>{this.isMobile=t.appWidth<=a.a.maxMobileWidth,this.setDivWidth(.4*t.appWidth>a.a.maxMobileWidth/1.5?"40%":a.a.maxMobileWidth/1.5+"px")})}setDivWidth(t){document.body.style.setProperty("--maxWidth",t)}getUserAndCart(){return Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.subscription1&&!this.subscription1.closed&&this.subscription1.unsubscribe(),this.subscription1=a.a.GetUserInfo().subscribe(t=>Object(c.b)(this,void 0,void 0,function*(){if(!t)return yield this.router.navigate(["/login"]),void(yield this.alertService.dismissLoading(this.loadingAlert));this.user=t,this.user&&this.user.cart&&this.user.cart.length>0?(this.hasProducts=!0,yield this.getProducts()):(this.hasProducts=!1,this.loading&&(yield this.alertService.dismissLoading(this.loadingAlert),this.loading=!1))}),t=>Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.presentAlert("Ops","Algo deu errado, tente novamente mais tarde.")}))})}getProducts(){return Object(c.b)(this,void 0,void 0,function*(){var t=[];if(this.subscriptions&&this.subscriptions.length>0){for(var i of this.subscriptions)i&&!i.closed&&i.unsubscribe();this.subscriptions=[]}var e=!0,s=!0,n=0,r=this.user.cart&&this.user.cart.length>0?this.user.cart.length:null;for(var o of this.user.cart)for(s=!0,this.subscriptions.push((yield this.prodServ.Get(o.productID)).subscribe(i=>{var c=i;c.id=o.productID,t.push({product:c,amount:o.amount}),++n>=r&&(e=!1),s=!1}));s;)yield new Promise(t=>setTimeout(t,10));for(;e;)yield new Promise(t=>setTimeout(t,10));this.products=t,this.loading&&(yield this.alertService.dismissLoading(this.loadingAlert),this.loading=!1)})}DecreaseAmount(t){return Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.cartServ.RemoveItem(t,this.user.cart),yield this.SendChanges(t,!1)})}IncreaseAmount(t,i,e){return Object(c.b)(this,void 0,void 0,function*(){e>=i?this.alertService.presentAlert("Ops","O produto n\xe3o possui mais estoque."):(yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.cartServ.AddItem(t,this.user.cart),yield this.SendChanges(t,!0))})}SendChanges(t,i){return Object(c.b)(this,void 0,void 0,function*(){yield this.userService.UpdateCart(this.user.id,this.user.cart).then(t=>Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.ShowToast("Itens Changed")}),e=>Object(c.b)(this,void 0,void 0,function*(){t&&null!=i&&(i?this.cartServ.RemoveItem(t,this.user.cart):this.cartServ.AddItem(t,this.user.cart),yield this.alertService.presentAlert("Oops",`There was a problem ${i?"increasing":"decreasing"} the amount of the item from the cart`))}))})}FinishPurchase(){return Object(c.b)(this,void 0,void 0,function*(){var t;if(yield this.alertService.confirmationAlert("Comprar","Clique em ok para efetuar a compra.").then(i=>t=i),t){for(var i of(yield this.alertService.presentLoading().then(t=>this.loadingAlert=t),this.products)){var e=!0,s=Object(u.a)(this.user.id,i.product.sellerID,{productID:i.product.id,amount:i.amount});for(yield this.purchaseService.Add(s).then(()=>Object(c.b)(this,void 0,void 0,function*(){yield this.prodServ.UpdateStock(i.product.id,i.product.stock-i.amount)})).catch(t=>{this.alertService.presentAlert("Ocorreu um erro",`Produto ${i.product.name} n\xe3o pode ser comprado, tente novamente mais tarde.`)}).finally(()=>{e=!1});e;)yield new Promise(t=>setTimeout(t,10))}yield this.userService.UpdateCart(this.user.id,[]).then(()=>Object(c.b)(this,void 0,void 0,function*(){this.user.cart=[],this.products=[],yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.presentAlert("Wheee","The itens you purchased will be shipped in the next 2534 years"),yield this.router.navigate(["/purchases/purchases"])}),t=>Object(c.b)(this,void 0,void 0,function*(){yield this.alertService.dismissLoading(this.loadingAlert),yield this.alertService.presentAlert("Ops","N\xe3o foi possivel remover os itens do carrinho apos a compra, Por favor verifique suas compras antes de comprar novamente.")}))}})}}return t.\u0275fac=function(i){return new(i||t)(l.Mb(d.a),l.Mb(h.a),l.Mb(o.g),l.Mb(b.a),l.Mb(p.a),l.Mb(g.a))},t.\u0275cmp=l.Gb({type:t,selectors:[["app-cart"]],decls:7,vars:7,consts:[["title","Carrinho","segment","0"],[3,"fullscreen"],["title","Carrinho","segment","1"],[3,"ngClass"],[4,"ngIf"],["vertical","bottom","expand","block","size","large","class","ion-margin",3,"click",4,"ngIf"],[1,"ion-text-center"],[4,"ngFor","ngForOf"],["size","9"],[3,"routerLink"],[3,"src","alt",4,"ngIf"],["size","1",1,"vertical-align-content","ion-justify-content-end"],["name","chevron-back-outline",3,"click"],["size","1",2,"text-align","center"],["size","1",1,"vertical-align-content","ion-justify-content-start"],["name","chevron-forward-outline",3,"click"],[3,"src","alt"],["vertical","bottom","expand","block","size","large",1,"ion-margin",3,"click"]],template:function(t,i){1&t&&(l.Nb(0,"app-header",0),l.Rb(1,"ion-content",1),l.Nb(2,"app-header",2),l.Rb(3,"div",3),l.pc(4,m,3,0,"div",4),l.pc(5,S,3,1,"ion-list",4),l.pc(6,I,2,0,"ion-button",5),l.Qb(),l.Qb()),2&t&&(l.Bb(1),l.gc("fullscreen",!0),l.Bb(2),l.gc("ngClass",l.jc(5,w,!i.isMobile)),l.Bb(1),l.gc("ngIf",!i.hasProducts),l.Bb(1),l.gc("ngIf",i.hasProducts),l.Bb(1),l.gc("ngIf",i.hasProducts))},directives:[f.a,r.m,s.i,s.k,r.y,r.n,s.j,r.H,r.l,r.s,r.bb,o.h,r.x,r.p,r.e],pipes:[s.c],styles:[".webrowser[_ngcontent-%COMP%]{text-align:center;width:var(--maxWidth);margin:0 auto;padding-top:1rem}img[_ngcontent-%COMP%]{border-radius:10%;height:40px;width:40px;margin:0 7px 0 0}.vertical-align-content[_ngcontent-%COMP%]{display:flex!important;align-content:center!important;align-items:center!important}"]}),t})()}];let O=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({imports:[[o.k.forChild(A)],o.k]}),t})();var R=e("dagM");let M=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({imports:[[s.b,n.a,r.T,O,R.a]]}),t})()}}]);